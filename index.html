<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <title>aircraft maintenance</title>
    <meta name="description" content="a series of quizzes, unless i get lazy">
    <meta name="author" content="Danae">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <style>
        * {
            text-align: center;
            font-family: Arial;
            background-color: #cdeaf7;
            color: black;
            font-size: 1.2rem;
        }

        .question {
            font-size: 2.2rem;
            margin-bottom: 20px;
        }

        #qlabel {
            margin-bottom: 20px;
            font-size: 2.2rem;
        }

        #var1,
        #var2 {
            font-size: 2.2rem;
        }

        #details {
            margin-top: 20px;
        }

        #answer:focus,
        #answer {
            border: none;
            border-bottom: 1px solid #ccc;
            font-size: 2.2rem;
            outline: none;
            max-width: 500px;
        }

        .green-text {
            color: green;
        }

        .red-text {
            color: red;
        }

        button {
            padding: 5px 50px;
            margin-top: 100px;
            border: none;
            background-color: #99d4e9;
            font-size: 1.5rem;
            text-transform: uppercase;
        }

        #test {
            margin-top: 50px;
        }

        #results{
            display: none;
        }

        #summary {
            display: none;
            margin: auto;
            margin-top: 50px;
            font-size: 2.2rem;
            border-bottom: 1px solid;
            max-width: 600px;
            padding-bottom: 20px;
        }

        #result-list li{
            padding: 10px 0;
        }
    </style>

    <script>
        // this is entirely coded by chatgpt im not gonna lie

        var questions = [];
        var questionCount = 5;
        var currentQuestion = 0;
        var seconds = 0;

        function startTest() {
            currentQuestion = 0;
            seconds = 0;
            questions = [];

            for (var i = 0; i < questionCount; i++) {
                questions.push(newQuestion())
            }

            nextQuestion();
            $("#test").show();
            $("#results").hide();
            $(".info").hide();
            $("#summary").hide();

            startTimer();

            $("#answer").on('keypress', function (e) {
                if (e.which == 13) {
                    var question = questions[currentQuestion - 1];
                    question.yourAnswer = $("#answer").val();
                    question.isCorrect = question.yourAnswer == question.answer;
                    $("#answer").val("");
                    nextQuestion();
                }
            });
        }

        var timeCounter;
        function startTimer() {
            var timeCounter = setTimeout(function () {
                seconds++;
                $("#details").text(`Question ${currentQuestion}/${questionCount} | Seconds: ${seconds}`);
                startTimer();
            }, 1000);
        }

        function endTimer() {
            clearTimeout(timeCounter);
        }

        function endTest() {
            endTimer();
            
            $("#test").hide();
            $("#result-list").html("")
            $("#results").show();
            $("#summary").show();

            var correctCount = 0;
            for (var i = 0; i < questions.length; i++) {
                var q = questions[i];
                $("#result-list")
                    .append(
            `<li>Question ${i+1}: ${q.question} <br> <span class="${q.isCorrect ? "green-text" : "red-text"}">Your Answer: ${q.yourAnswer} | Correct Answer: ${q.answer}</span></li>`);
                if (q.isCorrect)
                    correctCount++;
            }

            $("#summary").html(`Correct Answers: ${correctCount} of ${questionCount} <br>Time: ${seconds} seconds`);
        }

        function nextQuestion() {
            if (currentQuestion + 1 > questionCount) {
                endTest();
                return
            }

            currentQuestion++;

            var question = questions[currentQuestion - 1];

            $("#qlabel").text(question.question);

            $("#details").text(`Question ${currentQuestion}/${questionCount} | Seconds: ${seconds}`);
        }

        
        function notate(number) {
            const prefixes = ["p", "n", "u", "m", "", "k", "M", "G", "T"];

            if (isNaN(number) || number === 0) {
                return "0";
            }

            const exponent = Math.floor(Math.log10(Math.abs(number)) / 3);

            if (exponent < -4 || exponent > 4) {
                return "Out of range";
            }

            const normalizedNumber = number / Math.pow(10, exponent * 3);
            const prefix = prefixes[exponent + 4]; // Adjusting the index

            // Round the normalized number to a specific number of decimal places (e.g., 2)
            const roundedNumber = normalizedNumber.toFixed(0);

            return `${roundedNumber}${prefix}`;
        }


        function findVars() {
            const mylist = [1, 10, 100, 1000, 10000, 100000, 1000000, 0.1, 0.01, 0.001, 0.0001, 0.00001, 0.000001];
            const a = Math.floor(Math.random() * 5) + 1;
            const multiplier = Math.floor(Math.random() * 4) + 1;
            const b = a * multiplier;
            const mOrD = Math.floor(Math.random() * 2) + 1;
            const randomIndex1 = Math.floor(Math.random() * mylist.length);
            const aResult = a * mylist[randomIndex1];
            const randomIndex2 = Math.floor(Math.random() * mylist.length);
            const bResult = b * mylist[randomIndex2];
            return [aResult, bResult, mOrD];
        }

        function findAns(a, b, mOrD) {
            if (mOrD === 1) {
                return a * b;
            }
            return b / a;
        }
        
        function newQuestion() {
            const [a, b, mOrD] = findVars();
            const md = mOrD === 1 ? 'x' : '/';
            const ans = findAns(a, b, mOrD);
            
            // Format the ans variable with engineering notation
            const formattedAns = notate(ans);
            const formattedA = notate(a);
            const formattedB = notate(b);
            if (md === '/') {
                return{
                    question: `${formattedB} ${md} ${formattedA}`,
                    answer: formattedAns
                }
            }
            else {
                return{
                    question: `${formattedA} ${md} ${formattedB}`,
                    answer: formattedAns
                }
            }
        }

    </script>


</head>

<body>
    <div class="start">
        <h3>Aircraft Maintenance</h3>
        <p>Answers should be in the same format as the questions, no space and no units, just the number and prefix. It is also case-sensitive</p>
        <p>sometimes it will round a number when it shouldnt ill probably fix that eventually who knows just ignore it for now</p>
        <p>Press the reset button and then the quiz button if you want to try again</p>
        <button onclick="startTest()">
            prefix quiz!
        </button>
    </div>

    <div id="test">
        <div class="question">
            <div id="qlabel"></div>
        </div>

        <div>
            <input type="text" placeholder="type here" id="answer" autocomplete="off" />
        </div>

        <div id="details">
        </div>
    </div>


    <div id="summary">

    </div>

    <div id="results">
        <ul id="result-list">

        </ul>
        <button onclick="location.reload()">
            reset
        </button>
    </div>


</body>
</html>